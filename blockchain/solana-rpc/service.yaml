apiVersion: v1
kind: Service
metadata:
  name: solana-rpc
  namespace: blockchain
  labels:
    app: solana-rpc
    chain: solana
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8899"
spec:
  type: ClusterIP
  selector:
    app: solana-rpc
  ports:
    - name: rpc
      port: 8899
      targetPort: 8899
      protocol: TCP
    - name: rpc-ws
      port: 8900
      targetPort: 8900
      protocol: TCP
---
# Headless service for StatefulSet
apiVersion: v1
kind: Service
metadata:
  name: solana-rpc-headless
  namespace: blockchain
  labels:
    app: solana-rpc
spec:
  type: ClusterIP
  clusterIP: None
  selector:
    app: solana-rpc
  ports:
    - name: rpc
      port: 8899
      targetPort: 8899
    - name: rpc-ws
      port: 8900
      targetPort: 8900
---
# External LoadBalancer for RPC access
apiVersion: v1
kind: Service
metadata:
  name: solana-rpc-external
  namespace: blockchain
  labels:
    app: solana-rpc
  annotations:
    # AWS NLB
    # service.beta.kubernetes.io/aws-load-balancer-type: nlb
    # service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"
    # GCP
    # cloud.google.com/load-balancer-type: External
spec:
  type: LoadBalancer
  selector:
    app: solana-rpc
  ports:
    - name: rpc
      port: 8899
      targetPort: 8899
      protocol: TCP
    - name: rpc-ws
      port: 8900
      targetPort: 8900
      protocol: TCP
